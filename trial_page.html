<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>s - Foresight ARV</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/style.css" rel="stylesheet">
    <script src="https://unpkg.com/lucide@0.294.0/dist/umd/lucide.js"></script>
</head>
<body class="bg-light">
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i data-lucide="eye" class="me-2"></i>Foresight ARV
            </a>
            <div class="navbar-nav ms-auto">
                
                    <span class="navbar-text me-3">admin@example.com (Admin)</span>
                    <a class="nav-link" href="/logout">Logout</a>
                
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- Trial Header -->
        <div class="card mb-4">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <div>
                        <h1 class="h3 mb-0">s</h1>
                        <div class="mt-2">
                            <span class="badge 
                                bg-secondary
                                
                                
                                
                                me-2">Draft</span>
                            <span class="badge bg-outline-secondary">Lottery</span>
                        </div>
                    </div>
                    
                        
                            <!-- Website Admin Controls -->
                            <div class="admin-controls">
                                
                                <a href="/trials/23/start" class="btn btn-success me-2">
                                    <i data-lucide="play" class="me-1"></i>Start Trial
                                </a>
                                
                                <a href="/trials/23/edit" class="btn btn-outline-primary me-2">
                                    <i data-lucide="edit" class="me-1"></i>Edit Trial
                                </a>
                                
                            </div>
                        
                    
                </div>
                
                
                
                <div class="mt-3 pt-3 border-top">
                    <strong>Description:</strong> s
                </div>
                
            </div>
        </div>

        <!-- Responsive Outcomes Grid -->
        <div class="trial-outcomes-grid">
            
            <div class="outcome-card card h-100">
                <div class="card-header bg-light">
                    <h6 class="mb-0 text-center">Ball 1</h6>
                </div>
                <div class="card-body">
                    
                    <div class="targets-grid">
                        
                        <div class="target-container">
                            <!-- Image Display -->
                            
                                
                                    
                                    <!-- Admin/Trial Creator with Warning -->
                                    <div class="protected-image admin-protected" 
                                         data-user-type="admin"
                                         onclick="revealTargetImageAdmin(this)">
                                        <div class="protection-overlay">
                                            <button class="reveal-image-btn admin-reveal-btn">
                                                <i data-lucide="eye" class="me-1"></i>Reveal Image
                                            </button>
                                        </div>
                                        <img src="https://images.unsplash.com/photo-1544947950-fa07a98d237f?w=500&amp;h=500&amp;fit=crop&amp;crop=center" alt="" class="d-none target-image-hidden" />
                                    </div>
                                    
                                
                            
                            
                            <!-- Tags Display -->
                            <div class="target-tags">
                                
                                    
                                        
                                        <!-- Admin/Trial Creator Protected Tags -->
                                        <button class="btn btn-reveal-tags admin-reveal-tags" 
                                                data-user-type="admin"
                                                onclick="revealTagsAdmin(this)">
                                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24" class="me-1">
                                                <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
                                                <line x1="7" y1="7" x2="7.01" y2="7"></line>
                                            </svg>
                                            Reveal Tags
                                        </button>
                                        <div class="admin-protected-tags d-none">
                                            
                                                <div class="tag-list mt-2">
                                                    
                                                    <span class="badge bg-secondary me-1">cat</span>
                                                    
                                                    <span class="badge bg-secondary me-1">feline</span>
                                                    
                                                    <span class="badge bg-secondary me-1">pet</span>
                                                    
                                                    <span class="badge bg-secondary me-1">whiskers</span>
                                                    
                                                    <span class="badge bg-secondary me-1">furry</span>
                                                    
                                                    <span class="badge bg-secondary me-1">animal</span>
                                                    
                                                    <span class="badge bg-secondary me-1">cute</span>
                                                    
                                                </div>
                                            
                                        </div>
                                        
                                    
                                
                            </div>
                        </div>
                        
                    </div>
                    
                </div>
            </div>
            
            <div class="outcome-card card h-100">
                <div class="card-header bg-light">
                    <h6 class="mb-0 text-center">Ball 2</h6>
                </div>
                <div class="card-body">
                    
                    <div class="targets-grid">
                        
                        <div class="target-container">
                            <!-- Image Display -->
                            
                                
                                    
                                    <!-- Admin/Trial Creator with Warning -->
                                    <div class="protected-image admin-protected" 
                                         data-user-type="admin"
                                         onclick="revealTargetImageAdmin(this)">
                                        <div class="protection-overlay">
                                            <button class="reveal-image-btn admin-reveal-btn">
                                                <i data-lucide="eye" class="me-1"></i>Reveal Image
                                            </button>
                                        </div>
                                        <img src="https://images.unsplash.com/photo-1595246140220-f0515c4d4dda?w=500&amp;h=500&amp;fit=crop&amp;crop=center" alt="" class="d-none target-image-hidden" />
                                    </div>
                                    
                                
                            
                            
                            <!-- Tags Display -->
                            <div class="target-tags">
                                
                                    
                                        
                                        <!-- Admin/Trial Creator Protected Tags -->
                                        <button class="btn btn-reveal-tags admin-reveal-tags" 
                                                data-user-type="admin"
                                                onclick="revealTagsAdmin(this)">
                                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24" class="me-1">
                                                <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
                                                <line x1="7" y1="7" x2="7.01" y2="7"></line>
                                            </svg>
                                            Reveal Tags
                                        </button>
                                        <div class="admin-protected-tags d-none">
                                            
                                                <div class="tag-list mt-2">
                                                    
                                                    <span class="badge bg-secondary me-1">butterfly</span>
                                                    
                                                    <span class="badge bg-secondary me-1">wings</span>
                                                    
                                                    <span class="badge bg-secondary me-1">colorful</span>
                                                    
                                                    <span class="badge bg-secondary me-1">insect</span>
                                                    
                                                    <span class="badge bg-secondary me-1">delicate</span>
                                                    
                                                    <span class="badge bg-secondary me-1">nature</span>
                                                    
                                                    <span class="badge bg-secondary me-1">orange</span>
                                                    
                                                </div>
                                            
                                        </div>
                                        
                                    
                                
                            </div>
                        </div>
                        
                    </div>
                    
                </div>
            </div>
            
            <div class="outcome-card card h-100">
                <div class="card-header bg-light">
                    <h6 class="mb-0 text-center">Ball 3</h6>
                </div>
                <div class="card-body">
                    
                    <div class="targets-grid">
                        
                        <div class="target-container">
                            <!-- Image Display -->
                            
                                
                                    
                                    <!-- Admin/Trial Creator with Warning -->
                                    <div class="protected-image admin-protected" 
                                         data-user-type="admin"
                                         onclick="revealTargetImageAdmin(this)">
                                        <div class="protection-overlay">
                                            <button class="reveal-image-btn admin-reveal-btn">
                                                <i data-lucide="eye" class="me-1"></i>Reveal Image
                                            </button>
                                        </div>
                                        <img src="/static/avocado.svg" alt="" class="d-none target-image-hidden" />
                                    </div>
                                    
                                
                            
                            
                            <!-- Tags Display -->
                            <div class="target-tags">
                                
                                    
                                        
                                        <!-- Admin/Trial Creator Protected Tags -->
                                        <button class="btn btn-reveal-tags admin-reveal-tags" 
                                                data-user-type="admin"
                                                onclick="revealTagsAdmin(this)">
                                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24" class="me-1">
                                                <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
                                                <line x1="7" y1="7" x2="7.01" y2="7"></line>
                                            </svg>
                                            Reveal Tags
                                        </button>
                                        <div class="admin-protected-tags d-none">
                                            
                                                <div class="tag-list mt-2">
                                                    
                                                    <span class="badge bg-secondary me-1">avocado</span>
                                                    
                                                    <span class="badge bg-secondary me-1">green</span>
                                                    
                                                    <span class="badge bg-secondary me-1">healthy</span>
                                                    
                                                    <span class="badge bg-secondary me-1">creamy</span>
                                                    
                                                    <span class="badge bg-secondary me-1">pit</span>
                                                    
                                                    <span class="badge bg-secondary me-1">nutrition</span>
                                                    
                                                    <span class="badge bg-secondary me-1">fresh</span>
                                                    
                                                </div>
                                            
                                        </div>
                                        
                                    
                                
                            </div>
                        </div>
                        
                    </div>
                    
                </div>
            </div>
            
            <div class="outcome-card card h-100">
                <div class="card-header bg-light">
                    <h6 class="mb-0 text-center">Ball 4</h6>
                </div>
                <div class="card-body">
                    
                    <div class="targets-grid">
                        
                        <div class="target-container">
                            <!-- Image Display -->
                            
                                
                                    
                                    <!-- Admin/Trial Creator with Warning -->
                                    <div class="protected-image admin-protected" 
                                         data-user-type="admin"
                                         onclick="revealTargetImageAdmin(this)">
                                        <div class="protection-overlay">
                                            <button class="reveal-image-btn admin-reveal-btn">
                                                <i data-lucide="eye" class="me-1"></i>Reveal Image
                                            </button>
                                        </div>
                                        <img src="https://images.unsplash.com/photo-1565299624946-b28f40a0ca4b?w=500&amp;h=500&amp;fit=crop&amp;crop=center" alt="" class="d-none target-image-hidden" />
                                    </div>
                                    
                                
                            
                            
                            <!-- Tags Display -->
                            <div class="target-tags">
                                
                                    
                                        
                                        <!-- Admin/Trial Creator Protected Tags -->
                                        <button class="btn btn-reveal-tags admin-reveal-tags" 
                                                data-user-type="admin"
                                                onclick="revealTagsAdmin(this)">
                                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24" class="me-1">
                                                <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
                                                <line x1="7" y1="7" x2="7.01" y2="7"></line>
                                            </svg>
                                            Reveal Tags
                                        </button>
                                        <div class="admin-protected-tags d-none">
                                            
                                                <div class="tag-list mt-2">
                                                    
                                                    <span class="badge bg-secondary me-1">pizza</span>
                                                    
                                                    <span class="badge bg-secondary me-1">food</span>
                                                    
                                                    <span class="badge bg-secondary me-1">cheese</span>
                                                    
                                                    <span class="badge bg-secondary me-1">slice</span>
                                                    
                                                    <span class="badge bg-secondary me-1">italian</span>
                                                    
                                                    <span class="badge bg-secondary me-1">circular</span>
                                                    
                                                    <span class="badge bg-secondary me-1">delicious</span>
                                                    
                                                </div>
                                            
                                        </div>
                                        
                                    
                                
                            </div>
                        </div>
                        
                    </div>
                    
                </div>
            </div>
            
            <div class="outcome-card card h-100">
                <div class="card-header bg-light">
                    <h6 class="mb-0 text-center">Ball 5</h6>
                </div>
                <div class="card-body">
                    
                    <div class="targets-grid">
                        
                        <div class="target-container">
                            <!-- Image Display -->
                            
                                
                                    
                                    <!-- Admin/Trial Creator with Warning -->
                                    <div class="protected-image admin-protected" 
                                         data-user-type="admin"
                                         onclick="revealTargetImageAdmin(this)">
                                        <div class="protection-overlay">
                                            <button class="reveal-image-btn admin-reveal-btn">
                                                <i data-lucide="eye" class="me-1"></i>Reveal Image
                                            </button>
                                        </div>
                                        <img src="https://images.unsplash.com/photo-1486427944299-d1955d23e34d?w=500&amp;h=500&amp;fit=crop&amp;crop=center" alt="" class="d-none target-image-hidden" />
                                    </div>
                                    
                                
                            
                            
                            <!-- Tags Display -->
                            <div class="target-tags">
                                
                                    
                                        
                                        <!-- Admin/Trial Creator Protected Tags -->
                                        <button class="btn btn-reveal-tags admin-reveal-tags" 
                                                data-user-type="admin"
                                                onclick="revealTagsAdmin(this)">
                                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24" class="me-1">
                                                <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
                                                <line x1="7" y1="7" x2="7.01" y2="7"></line>
                                            </svg>
                                            Reveal Tags
                                        </button>
                                        <div class="admin-protected-tags d-none">
                                            
                                                <div class="tag-list mt-2">
                                                    
                                                    <span class="badge bg-secondary me-1">coffee</span>
                                                    
                                                    <span class="badge bg-secondary me-1">cup</span>
                                                    
                                                    <span class="badge bg-secondary me-1">hot</span>
                                                    
                                                    <span class="badge bg-secondary me-1">steam</span>
                                                    
                                                    <span class="badge bg-secondary me-1">brown</span>
                                                    
                                                    <span class="badge bg-secondary me-1">caffeine</span>
                                                    
                                                    <span class="badge bg-secondary me-1">morning</span>
                                                    
                                                </div>
                                            
                                        </div>
                                        
                                    
                                
                            </div>
                        </div>
                        
                    </div>
                    
                </div>
            </div>
            
        </div>

        <!-- Remote Viewing Session -->
        

        <!-- Predictions Section -->
        

        <!-- Back to Trials -->
        <div class="mb-4">
            <a href="/trials" class="btn btn-outline-secondary">
                <i data-lucide="arrow-left" class="me-2"></i>Back to Trials
            </a>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Initialize Lucide icons directly
        if (typeof window.initializeLucideIcons === 'function') {
            try { window.initializeLucideIcons(); } catch(e) { console.warn('Icon initialization error:', e); }
        }
        
        // Track if user has viewed content
        let hasViewedContent = false;
        
        // Admin/Trial Creator reveal image with warning
        function revealTargetImageAdmin(element) {
            const userType = element.dataset.userType;
            const userTypeText = userType === 'admin' ? 'Website Administrator' : 'Trial Creator';
            
            const message = `WARNING: ${userTypeText}\n\n` +
                          `Viewing this image will prevent you from participating in this trial's remote viewing session. ` +
                          `This restriction maintains the scientific integrity of the ARV process.\n\n` +
                          `Do you want to continue and view the image?`;
            
            if (confirm(message)) {
                const overlay = element.querySelector('.protection-overlay');
                const hiddenImage = element.querySelector('.target-image-hidden');
                
                if (overlay && hiddenImage) {
                    overlay.style.display = 'none';
                    hiddenImage.classList.remove('d-none');
                    hiddenImage.classList.add('target-image');
                    hiddenImage.style.display = 'block';
                    
                    // Mark as viewed and update participation status
                    hasViewedContent = true;
                    updateParticipationStatus();
                }
            }
        }
        
        // Admin/Trial Creator reveal tags with warning
        function revealTagsAdmin(button) {
            const userType = button.dataset.userType;
            const userTypeText = userType === 'admin' ? 'Website Administrator' : 'Trial Creator';
            
            const message = `WARNING: ${userTypeText}\n\n` +
                          `Viewing these tags will prevent you from participating in this trial's remote viewing session. ` +
                          `This restriction maintains the scientific integrity of the ARV process.\n\n` +
                          `Do you want to continue and view the tags?`;
            
            if (confirm(message)) {
                const container = button.closest('.target-tags');
                const protectedTags = container.querySelector('.admin-protected-tags');
                
                if (protectedTags) {
                    button.style.display = 'none';
                    protectedTags.classList.remove('d-none');
                    
                    // Mark as viewed and update participation status
                    hasViewedContent = true;
                    updateParticipationStatus();
                }
            }
        }
        
        // Update participation status
        function updateParticipationStatus() {
            const rvCard = document.getElementById('rv-session-card');
            const predictionCard = document.getElementById('prediction-card');
            
            if (hasViewedContent && rvCard) {
                const participationCheck = rvCard.querySelector('#participation-check');
                const rvForm = rvCard.querySelector('#rv-form');
                
                if (participationCheck && rvForm) {
                    participationCheck.classList.remove('d-none');
                    rvForm.classList.add('d-none');
                }
            }
        }
        
        // Check participation eligibility for descriptors
        function checkParticipationEligibility() {
            if (hasViewedContent) {
                alert('You cannot submit observations because you have viewed target content for this trial. This maintains the scientific integrity of the remote viewing process.');
                return false;
            }
            // Proceed with submission
            return true;
        }
        
        // Check prediction eligibility
        function checkPredictionEligibility(event) {
            if (hasViewedContent) {
                event.preventDefault();
                alert('You cannot make predictions because you have viewed target content for this trial. This maintains the scientific integrity of the remote viewing process.');
                return false;
            }
            return true;
        }
        
        // Reveal target image for admin/trial creator with warning
        function revealTargetImageAdmin(element) {
            const userType = element.dataset.userType;
            const isAdmin = userType === 'admin';
            
            const message = `Warning: Viewing target images may compromise your ability to participate in this trial.\n\n` +
                          `Once you view any target content, you will be blocked from making predictions or submitting observations ` +
                          `to maintain the scientific integrity of the remote viewing process.\n\n` +
                          `Are you sure you want to reveal this image?`;
            
            if (confirm(message)) {
                // Hide the overlay and show the image
                const overlay = element.querySelector('.protection-overlay');
                const image = element.querySelector('.target-image-hidden');
                
                if (overlay && image) {
                    overlay.style.display = 'none';
                    image.classList.remove('d-none');
                    image.classList.add('target-image');
                    
                    // Mark that content has been viewed
                    hasViewedContent = true;
                    updateParticipationStatus();
                }
            }
        }
        

        
        // Confirm trial deletion (admin only)
        function confirmDeleteTrial() {
            const message = 'Are you sure you want to delete this trial? This action cannot be undone and will remove all associated data.';
            if (confirm(message)) {
                // Implement deletion logic here
                window.location.href = `/trials/23/delete`;
            }
        }
    </script>
    
    <!-- WebSocket Connection -->
    <script src="/static/app.js"></script>
</body>
</html>